<!DOCTYPE html>
<html>
<head>
    <title>J.U.L.E.S. - WebVM Environment</title>
    <style>
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background-color: #000; }
        #terminal-container { width: 100%; height: 100%; }
    </style>
</head>
<body>
    <div id="terminal-container"></div>
    <input type="file" id="file-input" multiple style="display: none;" />
    <button id="upload-button">Upload Files</button>
    <script type="module">
        import { Terminal } from "https://cdn.jsdelivr.net/npm/xterm@5.3.0/lib/xterm.min.js";
        import { WebVM } from "https://cdn.jsdelivr.net/npm/webvm@latest/dist/webvm.js";

        const terminal = new Terminal({ cursorBlink: true });
        const webvm = new WebVM({
            "cmd": "/bin/bash",
            "args": ["--login"],
            "env": {
                "HOME": "/home/user",
                "TERM": "xterm-256color"
            },
            "mounts": [
                {
                    "type": "tmpfs",
                    "path": "/home/user/project"
                }
            ]
        });

        terminal.open(document.getElementById('terminal-container'));
        webvm.on('data', (data) => terminal.write(data));
        terminal.onData((data) => webvm.write(data));

        document.getElementById('upload-button').addEventListener('click', () => {
            document.getElementById('file-input').click();
        });

        document.getElementById('file-input').addEventListener('change', async (event) => {
            const files = event.target.files;
            if (files.length === 0) return;

            for (const file of files) {
                const content = await file.arrayBuffer();
                const path = `/home/user/project/${file.name}`;
                await webvm.fs.writeFile(path, new Uint8Array(content));
                terminal.write(`Uploaded ${file.name} to ${path}\r\n`);
            }
        });

        webvm.start();
    </script>
</body>
</html>